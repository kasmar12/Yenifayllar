# SMM Panel - PHP Web Application

A complete Social Media Marketing (SMM) panel web application built with PHP, MySQL, and integrated with Portmanat.az payment gateway and SMM API services.

## Features

- **Modern Bootstrap UI** - Responsive design with beautiful gradients and animations
- **Portmanat.az Integration** - Secure payment processing for Azerbaijani users
- **SMM API Integration** - Automatic order processing with SMM service providers
- **Database Management** - PDO-based MySQL database operations
- **Order Tracking** - Complete order lifecycle management
- **Security Features** - SHA256 signature verification, input validation, SQL injection protection

## Project Structure

```
smm-panel/
├── config.php          # Configuration file with API keys and database settings
├── index.php           # Main homepage with order form
├── payment.php         # Payment initialization and Portmanat redirect
├── callback.php        # Portmanat payment notification handler
├── success.php         # Payment success page
├── fail.php            # Payment failure page
├── db.sql             # Database schema and table creation
├── README.md          # This file
└── test_db.php        # Database connection test file
```

## Requirements

- **PHP**: 7.4 or higher
- **MySQL**: 5.7 or higher
- **Web Server**: Apache/Nginx with PHP support
- **PHP Extensions**: PDO, PDO_MySQL, cURL, JSON
- **Portmanat.az Account**: Merchant ID and Secret Key
- **SMM Provider Account**: API key and service ID

## Installation

### 1. Database Setup

```sql
# Import the database schema
mysql -u root -p < db.sql

# Or manually create the database and table
CREATE DATABASE smm_panel CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE smm_panel;

# Then run the CREATE TABLE statement from db.sql
```

### 2. Configuration

Edit `config.php` and update the following settings:

```php
// Database Configuration
define('DB_HOST', 'localhost');        // Your database host
define('DB_NAME', 'smm_panel');        // Database name
define('DB_USER', 'your_db_user');     // Database username
define('DB_PASS', 'your_db_password'); // Database password

// Portmanat.az API Configuration
define('PORTMANAT_MERCHANT_ID', 'YOUR_MERCHANT_ID');     // Your Portmanat merchant ID
define('PORTMANAT_SECRET_KEY', 'YOUR_SECRET_KEY');       // Your Portmanat secret key
define('PORTMANAT_API_URL', 'https://portmanat.az/api/payment'); // Portmanat API URL

// SMM API Configuration
define('SMM_API_URL', 'https://your-smm-provider.com/api/v2'); // Your SMM provider API URL
define('SMM_API_KEY', 'YOUR_SMM_API_KEY');                     // Your SMM provider API key
define('SMM_SERVICE_ID', '123');                               // Your SMM service ID

// Pricing Configuration
define('PRICE_PER_1000', 25.00);                               // Price per 1000 followers/likes/views (in AZN)

// Application Configuration
define('SITE_URL', 'https://yourdomain.com/smm-panel'); // Your website URL
```

### 3. File Permissions

Ensure your web server has read/write permissions to the application directory.

### 4. Web Server Configuration

#### Apache (.htaccess)
```apache
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]
```

#### Nginx
```nginx
location / {
    try_files $uri $uri/ /index.php?$query_string;
}
```

## Payment Workflow

1. **Order Creation**: User fills the form on `index.php`
2. **Database Storage**: Order is saved with `status = 'pending'`
3. **Payment Redirect**: User is redirected to `payment.php` with order details
4. **Portmanat Integration**: Payment form is submitted to Portmanat.az
5. **Payment Processing**: User completes payment on Portmanat.az
6. **Callback Processing**: Portmanat sends notification to `callback.php`
7. **SMM API Call**: If payment successful, SMM API is called automatically
8. **Order Completion**: Order status is updated based on SMM API response

## API Integration

### Portmanat.az Integration

The application integrates with Portmanat.az using the following parameters:

- `merchant_id`: Your merchant identifier
- `order_id`: Unique order ID generated by the system
- `amount`: Order amount in AZN
- `description`: Order description
- `success_url`: Redirect URL after successful payment
- `fail_url`: Redirect URL after failed payment
- `notify_url`: Webhook URL for payment notifications
- `signature`: SHA256 hash for security verification

### SMM API Integration

After successful payment, the system automatically calls your SMM provider's API:

```php
$smm_data = [
    'key' => SMM_API_KEY,
    'action' => 'add',
    'service' => SMM_SERVICE_ID,
    'link' => $order['link'],
    'quantity' => $order['quantity']
];
```

## Security Features

- **SHA256 Signature Verification**: All Portmanat callbacks are verified
- **SQL Injection Protection**: PDO prepared statements
- **Input Validation**: Server-side validation for all user inputs
- **XSS Protection**: HTML escaping for all output
- **Error Logging**: Comprehensive logging for debugging

## Customization

### Adding New SMM Services

1. Update `SMM_SERVICE_ID` in `config.php`
2. Modify the `callSmmApi()` function in `callback.php` if needed
3. Adjust success/failure conditions based on your provider's API response format

### Styling Changes

The application uses Bootstrap 5 with custom CSS. Modify the `<style>` sections in each PHP file to customize the appearance.

### Database Schema

To add new fields to the orders table:

```sql
ALTER TABLE orders ADD COLUMN new_field VARCHAR(255) AFTER existing_field;
```

## Troubleshooting

### Common Issues

1. **Database Connection Failed**
   - Check database credentials in `config.php`
   - Ensure MySQL service is running
   - Verify database exists and user has permissions

2. **Payment Not Processing**
   - Check Portmanat API credentials
   - Verify `notify_url` is accessible from Portmanat servers
   - Check server error logs for callback issues

3. **SMM API Not Working**
   - Verify SMM API credentials and URL
   - Check API response format in `callback.php`
   - Ensure cURL extension is enabled

### Debug Mode

Enable debug mode in `config.php`:

```php
define('DEBUG_MODE', true);
```

This will enable error reporting and detailed logging.

### Log Files

Check your server's error log for debugging information:
- Apache: `/var/log/apache2/error.log`
- Nginx: `/var/log/nginx/error.log`
- PHP: `/var/log/php/error.log`

## Testing

1. **Database Test**: Use `test_db.php` to verify database connectivity
2. **Payment Test**: Use Portmanat's test environment for development
3. **SMM API Test**: Test with your SMM provider's test API endpoints

## Production Deployment

Before going live:

1. Set `DEBUG_MODE = false` in `config.php`
2. Use HTTPS for all URLs
3. Set proper file permissions
4. Configure error logging
5. Test with real Portmanat credentials
6. Verify SMM API integration

## Support

For technical support or customization requests, please contact your development team or refer to the code comments for implementation details.

## License

This project is provided as-is for educational and commercial use. Please ensure compliance with Portmanat.az and your SMM provider's terms of service.

## Changelog

### Version 1.0.0
- Initial release
- Complete SMM panel functionality
- Portmanat.az integration
- Bootstrap 5 UI
- MySQL database integration
- Comprehensive error handling